{"version":3,"sources":["webpack:///webpack/bootstrap ea66ac91bf687f49cb52","webpack:///./lib/p5-widget.ts","webpack:///./lib/defaults.ts"],"names":[],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uBAAe;AACf;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;;ACtCA,KAAY,QAAQ,uBAAM,CAAY,CAAC;AAEvC,KAAM,WAAW,GAAG,cAAc,CAAC;AACnC,KAAM,eAAe,GAAG,gBAAgB,CAAC;AACzC,KAAM,YAAY,GAAG;KACnB,aAAa;KACb,yBAAyB;KACzB,2BAA2B;KAC3B,wBAAwB;EACzB,CAAC;AACF,KAAM,4BAA4B,GAAG,IAAI,CAAC;AAE1C,KAAI,UAAU,GAAG,aAAa,EAAuB,CAAC;AACtD,KAAI,SAAS,GAAG,YAAY,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC;AAC7C,KAAI,QAAQ,GAAG,CAAC,UAAU,CAAC,YAAY,CAAC,aAAa,CAAC,CAAC;AACvD,KAAI,MAAM,GAAG,CAAC,CAAC;AAEf,uBAAsB,GAAW;KAC/B,IAAI,OAAO,GAAG,GAAG,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;KAEhD,EAAE,CAAC,CAAC,4BAA4B,CAAC,CAAC,CAAC;SACjC,EAAE,CAAC,CAAC,MAAM,CAAC,QAAQ,CAAC,QAAQ,KAAK,OAAO,IAAI,SAAS,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;aACpE,8DAA8D;aAC9D,iEAAiE;aACjE,kEAAkE;aAClE,gEAAgE;aAChE,yBAAyB;aAEzB,OAAO,GAAG,OAAO,CAAC,OAAO,CAAC,QAAQ,EAAE,OAAO,CAAC,CAAC;SAC/C,CAAC;KACH,CAAC;KAED,MAAM,CAAC,OAAO,CAAC;AACjB,EAAC;AAED;KACE,MAAM,CAAC,CACL,QAAQ,CAAC,aAAa;SACtB,QAAQ,CAAC,gBAAgB,CAAC,eAAe,GAAG,WAAW,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,CACnE,CAAC;AACJ,EAAC;AAED,8CAA6C;AAC7C,8BAA6B,EAAe;KAC1C,IAAI,IAAI,GAAG,EAAE,CAAC,qBAAqB,EAAE,CAAC;KAEtC,MAAM,CAAC,CACL,IAAI,CAAC,MAAM,IAAI,CAAC;SAChB,IAAI,CAAC,KAAK,IAAI,CAAC;SACf,IAAI,CAAC,GAAG,IAAI,CAAC,MAAM,CAAC,WAAW;aAClB,QAAQ,CAAC,eAAe,CAAC,YAAY,CAAC;SACnD,IAAI,CAAC,IAAI,IAAI,CAAC,MAAM,CAAC,UAAU;aACjB,QAAQ,CAAC,eAAe,CAAC,WAAW,CAAC,CACpD,CAAC;AACJ,EAAC;AAED,wBAAuB,EAAqB;KAC1C,IAAI,MAAM,GAAG,QAAQ,CAAC,EAAE,CAAC,YAAY,CAAC,aAAa,CAAC,CAAC,CAAC;KAEtD,EAAE,CAAC,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;SAAC,MAAM,GAAG,QAAQ,CAAC,MAAM,CAAC;KAE5C,MAAM,CAAC,MAAM,CAAC;AAChB,EAAC;AAED,sBAAqB,GAAW;KAC9B,IAAI,CAAC,GAAG,QAAQ,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC;KACpC,CAAC,CAAC,YAAY,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC;KAE5B,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC;AAChB,EAAC;AAED,oBAAmB,GAAW,EAAE,EAA2B;KACzD,IAAI,KAAK,GAAG,UAAC,GAAS;SACpB,IAAI,KAAK,GAAG,CAAC,qCAAqC,GAAG,GAAG,GAAG,GAAG,CAAC,CAAC;SAEhE,EAAE,CAAC,CAAC,GAAG,IAAI,OAAM,CAAC,GAAG,CAAC,IAAI,QAAQ,CAAC,CAAC,CAAC;aACnC,KAAK,CAAC,IAAI,CAAC,KAAK,GAAG,GAAG,CAAC,CAAC;SAC1B,CAAC;SAED,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;KACvB,CAAC,CAAC;KACF,IAAI,GAAG,GAAG,IAAI,cAAc,EAAE,CAAC;KAC/B,GAAG,CAAC,IAAI,CAAC,KAAK,EAAE,GAAG,CAAC,CAAC;KAErB,GAAG,CAAC,MAAM,GAAG;SACX,EAAE,CAAC,CAAC,GAAG,CAAC,MAAM,IAAI,GAAG,CAAC,CAAC,CAAC;aACtB,EAAE,CAAC,GAAG,CAAC,YAAY,CAAC,CAAC;SACvB,CAAC;SAAC,IAAI,CAAC,CAAC;aACN,KAAK,CAAC,uBAAuB,GAAG,GAAG,CAAC,MAAM,GAAG,GAAG,CAAC,CAAC;SACpD,CAAC;KACH,CAAC,CAAC;KAEF,GAAG,CAAC,OAAO,GAAG,KAAK,CAAC;KACpB,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;AACjB,EAAC;AAED,kCAAiC,EAAqB;KACpD,IAAI,MAAM,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;KAC9C,IAAI,MAAM,GAAG,aAAa,CAAC,EAAE,CAAC,CAAC;KAC/B,IAAI,YAAY,GAAG,QAAQ,CAAC,EAAE,CAAC,YAAY,CAAC,oBAAoB,CAAC,CAAC,CAAC;KACnE,IAAI,aAAa,GAAG,WAAW,CAAC,EAAE,CAAC,YAAY,CAAC,eAAe,CAAC,CAAC,CAAC;KAClE,IAAI,SAAS,GAAG,EAAE,CAAC,YAAY,CAAC,iBAAiB,CAAC,CAAC;KACnD,IAAI,UAAU,GAAG,QAAQ,CAAC,EAAE,CAAC,YAAY,CAAC,mBAAmB,CAAC,CAAC,CAAC;KAChE,IAAI,QAAQ,GAAG,EAAE,CAAC,YAAY,CAAC,eAAe,CAAC,CAAC;KAChD,IAAI,GAAG,CAAC;KACR,IAAI,MAAM,GAAG;SACX,KAAK,GAAG,kBAAkB,CAAC,EAAE,CAAC,YAAY,CAAC,SAAS,CAAC,CAAC;MACvD,CAAC;KACF,IAAI,KAAK,GAAG,YAAY,CAAC,KAAK,EAAE,CAAC;KAEjC,oBAAoB,MAAc;SAChC,MAAM,CAAC,IAAI,CAAC,SAAS,GAAG,kBAAkB,CAAC,MAAM,CAAC,CAAC,CAAC;SACpD,KAAK,CAAC,IAAI,CAAC,cAAc,GAAG,MAAM,GAAG,IAAI,CAAC,CAAC;SAC3C,GAAG,GAAG,SAAS,GAAG,eAAe,GAAG,GAAG,GAAG,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;SAC3D,MAAM,CAAC,YAAY,CAAC,KAAK,EAAE,GAAG,CAAC,CAAC;SAChC,MAAM,CAAC,YAAY,CAAC,OAAO,EAAE,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;SAC/C,EAAE,CAAC,UAAU,CAAC,YAAY,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC;KACzC,CAAC;KAED,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,YAAY,CAAC,IAAI,YAAY,IAAI,CAAC,CAAC,CAAC,CAAC;SAC9C,MAAM,CAAC,IAAI,CAAC,eAAe,GAAG,YAAY,CAAC,CAAC;KAC9C,CAAC;KAED,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,UAAU,CAAC,IAAI,UAAU,IAAI,CAAC,CAAC,CAAC,CAAC;SAC1C,MAAM,CAAC,IAAI,CAAC,aAAa,GAAG,UAAU,CAAC,CAAC;KAC1C,CAAC;KAED,EAAE,CAAC,CAAC,aAAa,CAAC,CAAC,CAAC;SAClB,MAAM,CAAC,IAAI,CAAC,gBAAgB,GAAG,kBAAkB,CAAC,aAAa,CAAC,CAAC,CAAC;KACpE,CAAC;KAED,EAAE,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC;SACd,MAAM,CAAC,IAAI,CAAC,YAAY,GAAG,kBAAkB,CAAC,SAAS,CAAC,CAAC,CAAC;KAC5D,CAAC;KAED,EAAE,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC;SACb,MAAM,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;KAC7B,CAAC;KAED,EAAE,CAAC,CAAC,EAAE,CAAC,GAAG,IAAI,EAAE,CAAC,WAAW,IAAI,EAAE,CAAC,WAAW,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;SACtD,MAAM,CAAC,UAAU,CAAC;aAChB,kEAAkE;aAClE,8DAA8D;UAC/D,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;KAChB,CAAC;KAED,EAAE,CAAC,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC;SACX,SAAS,CAAC,EAAE,CAAC,GAAG,EAAE,UAAU,CAAC,CAAC;KAChC,CAAC;KAAC,IAAI,CAAC,CAAC;SACN,UAAU,CAAC,EAAE,CAAC,WAAW,CAAC,CAAC;KAC7B,CAAC;AACH,EAAC;AAED,sBAAqB,EAAqB,EACrB,EAAmC;KACtD,IAAI,iBAAiB,GAAG,IAAI,CAAC;KAC7B,IAAI,QAAgB,CAAC;KAErB;SACE,EAAE,CAAC,CAAC,CAAC,mBAAmB,CAAC,EAAE,CAAC,CAAC;aAAC,MAAM,CAAC;SAErC,aAAa,CAAC,QAAQ,CAAC,CAAC;SACxB,MAAM,CAAC,mBAAmB,CAAC,QAAQ,EAAE,gBAAgB,EAAE,KAAK,CAAC,CAAC;SAC9D,MAAM,CAAC,mBAAmB,CAAC,QAAQ,EAAE,gBAAgB,EAAE,KAAK,CAAC,CAAC;SAC9D,EAAE,CAAC,EAAE,CAAC,CAAC;KACT,CAAC;KAED,8DAA8D;KAC9D,+DAA+D;KAC/D,sDAAsD;KACtD,+BAA+B;KAC/B,QAAQ,GAAG,WAAW,CAAC,gBAAgB,EAAE,IAAI,CAAC,CAAC;KAE/C,MAAM,CAAC,gBAAgB,CAAC,QAAQ,EAAE,gBAAgB,EAAE,KAAK,CAAC,CAAC;KAC3D,MAAM,CAAC,gBAAgB,CAAC,QAAQ,EAAE,gBAAgB,EAAE,KAAK,CAAC,CAAC;KAC3D,gBAAgB,EAAE,CAAC;AACrB,EAAC;AAED,wCAAuC,EAAqB;KAC1D,IAAI,MAAM,GAAG,aAAa,CAAC,EAAE,CAAC,CAAC;KAE/B,EAAE,CAAC,KAAK,CAAC,OAAO,GAAG,OAAO,CAAC;KAC3B,EAAE,CAAC,KAAK,CAAC,QAAQ,GAAG,GAAG,CAAC;KACxB,EAAE,CAAC,KAAK,CAAC,KAAK,GAAG,MAAM,CAAC;KACxB,EAAE,CAAC,KAAK,CAAC,SAAS,GAAG,MAAM,GAAG,IAAI,CAAC;KACnC,EAAE,CAAC,KAAK,CAAC,UAAU,GAAG,SAAS,CAAC;KAEhC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,YAAY,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;SAChC,EAAE,CAAC,YAAY,CAAC,SAAS,EAAE,MAAM,CAAC,QAAQ,EAAE,CAAC,CAAC;SAC9C,MAAM,EAAE,CAAC;KACX,CAAC;KAED,WAAW,CAAC,EAAE,EAAE,uBAAuB,CAAC,CAAC;AAC3C,EAAC;AAED;KACE,IAAI,OAAO,GAAG,QAAQ,CAAC,gBAAgB,CAAC,wBAAwB,CAAC,CAAC;KAElE,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,OAAO,CAAC,UAAC,EAAqB;SACnD,6BAA6B,CAAC,EAAE,CAAC,CAAC;KACpC,CAAC,CAAC,CAAC;AACL,EAAC;AAED,GAAE,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC;KACb,EAAE,CAAC,CAAC,QAAQ,CAAC,UAAU,KAAK,UAAU,CAAC,CAAC,CAAC;SACvC,iCAAiC,EAAE,CAAC;KACtC,CAAC;KAAC,IAAI,CAAC,CAAC;SACN,MAAM,CAAC,gBAAgB,CACrB,MAAM,EACN,iCAAiC,EACjC,KAAK,CACN,CAAC;KACJ,CAAC;AACH,EAAC;AAED,OAAM,CAAC,UAAU,CAAC,GAAG;KACnB,OAAO,EAAE,SAAS;KAClB,GAAG,EAAE,SAAS,GAAG,WAAW;KAC5B,aAAa,EAAE,6BAA6B;KAC5C,UAAU,EAAE,iCAAiC;KAC7C,QAAQ,EAAE,QAAQ;EACnB,CAAC;;;;;;;;AC7NW,mBAAU,GAAG,QAAQ,CAAC;AACtB,sBAAa,GAAG,GAAG,CAAC;AACpB,eAAM,GAAG,GAAG,CAAC;AACb,qBAAY,GAAG,IAAI,CAAC","file":"p5-widget.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap ea66ac91bf687f49cb52","import * as defaults from \"./defaults\";\n\nconst MY_FILENAME = 'p5-widget.js';\nconst IFRAME_FILENAME = 'p5-widget.html';\nconst IFRAME_STYLE = [\n  'width: 100%',\n  'background-color: white',\n  'border: 1px solid #ec245e',\n  'box-sizing: border-box'\n];\nconst AVOID_MIXED_CONTENT_WARNINGS = true;\n\nlet myScriptEl = getMyScriptEl() as HTMLScriptElement;\nlet myBaseURL = getMyBaseURL(myScriptEl.src);\nlet autoload = !myScriptEl.hasAttribute('data-manual');\nlet nextId = 1;\n\nfunction getMyBaseURL(url: string) {\n  let baseURL = url.slice(0, -MY_FILENAME.length);\n\n  if (AVOID_MIXED_CONTENT_WARNINGS) {\n    if (window.location.protocol === 'http:' && /^https:/.test(baseURL)) {\n      // Our script was loaded over HTTPS, but the embedding page is\n      // using HTTP. This is likely to result in mixed content warnings\n      // if e.g. the widget's sketch wants to load resources relative to\n      // the embedding page's URL, so let's just embed the widget over\n      // HTTP instead of HTTPS.\n\n      baseURL = baseURL.replace('https:', 'http:');\n    }\n  }\n\n  return baseURL;\n}\n\nfunction getMyScriptEl() {\n  return (\n    document.currentScript ||\n    document.querySelectorAll(\"script[src$='\" + MY_FILENAME + \"']\")[0]\n  );\n}\n\n// http://stackoverflow.com/a/7557433/2422398\nfunction isElementInViewport(el: HTMLElement) {\n  var rect = el.getBoundingClientRect();\n\n  return (\n    rect.bottom >= 0 &&\n    rect.right >= 0 &&\n    rect.top <= (window.innerHeight ||\n                 document.documentElement.clientHeight) &&\n    rect.left <= (window.innerWidth ||\n                  document.documentElement.clientWidth)\n  );\n}\n\nfunction getDataHeight(el: HTMLScriptElement) {\n  let height = parseInt(el.getAttribute('data-height'));\n\n  if (isNaN(height)) height = defaults.HEIGHT;\n\n  return height;\n}\n\nfunction absoluteURL(url: string) {\n  let a = document.createElement('a');\n  a.setAttribute('href', url);\n\n  return a.href;\n}\n\nfunction getSketch(url: string, cb: (sketch: string) => any) {\n  let error = (msg?: any) => {\n    let lines = ['// p5.js-widget failed to retrieve ' + url + '.'];\n\n    if (msg && typeof(msg) == 'string') {\n      lines.push('// ' + msg);\n    }\n\n    cb(lines.join('\\n'));\n  };\n  let req = new XMLHttpRequest();\n  req.open('GET', url);\n\n  req.onload = () => {\n    if (req.status == 200) {\n      cb(req.responseText);\n    } else {\n      error('Server returned HTTP ' + req.status + '.');\n    }\n  };\n\n  req.onerror = error;\n  req.send(null);\n}\n\nfunction replaceScriptWithWidget(el: HTMLScriptElement) {\n  let iframe = document.createElement('iframe');\n  let height = getDataHeight(el);\n  let previewWidth = parseInt(el.getAttribute('data-preview-width'));\n  let baseSketchURL = absoluteURL(el.getAttribute('data-base-url'));\n  let p5version = el.getAttribute('data-p5-version');\n  let maxRunTime = parseInt(el.getAttribute('data-max-run-time'));\n  let autoplay = el.hasAttribute('data-autoplay');\n  let url;\n  let qsArgs = [\n    'id=' + encodeURIComponent(el.getAttribute('data-id'))\n  ];\n  let style = IFRAME_STYLE.slice();\n\n  function makeWidget(sketch: string) {\n    qsArgs.push('sketch=' + encodeURIComponent(sketch));\n    style.push('min-height: ' + height + 'px');\n    url = myBaseURL + IFRAME_FILENAME + '?' + qsArgs.join('&');\n    iframe.setAttribute('src', url);\n    iframe.setAttribute('style', style.join('; '));\n    el.parentNode.replaceChild(iframe, el);\n  }\n\n  if (!isNaN(previewWidth) && previewWidth >= 0) {\n    qsArgs.push('previewWidth=' + previewWidth);\n  }\n\n  if (!isNaN(maxRunTime) && maxRunTime >= 0) {\n    qsArgs.push('maxRunTime=' + maxRunTime);\n  }\n\n  if (baseSketchURL) {\n    qsArgs.push('baseSketchURL=' + encodeURIComponent(baseSketchURL));\n  }\n\n  if (p5version) {\n    qsArgs.push('p5version=' + encodeURIComponent(p5version));\n  }\n\n  if (autoplay) {\n    qsArgs.push('autoplay=on');\n  }\n\n  if (el.src && el.textContent && el.textContent.trim()) {\n    return makeWidget([\n      '// Your widget includes both a \"src\" attribute and inline script',\n      '// content, which makes no sense. Please remove one of them.'\n    ].join('\\n'));\n  }\n\n  if (el.src) {\n    getSketch(el.src, makeWidget);\n  } else {\n    makeWidget(el.textContent);\n  }\n}\n\nfunction whenVisible(el: HTMLScriptElement,\n                     cb: (el: HTMLScriptElement) => void) {\n  let CHECK_INTERVAL_MS = 1000;\n  let interval: number;\n\n  function maybeMakeVisible() {\n    if (!isElementInViewport(el)) return;\n\n    clearInterval(interval);\n    window.removeEventListener('scroll', maybeMakeVisible, false);\n    window.removeEventListener('resize', maybeMakeVisible, false);\n    cb(el);\n  }\n\n  // We want to check at a fixed interval as a fallback, to make\n  // sure that we detect when the element is visible even outside\n  // of the usual means (e.g., because the user did some\n  // sort of pinch/zoom gesture).\n  interval = setInterval(maybeMakeVisible, 1000);\n\n  window.addEventListener('scroll', maybeMakeVisible, false);\n  window.addEventListener('resize', maybeMakeVisible, false);\n  maybeMakeVisible();\n}\n\nfunction lazilyReplaceScriptWithWidget(el: HTMLScriptElement) {\n  let height = getDataHeight(el);\n\n  el.style.display = 'block';\n  el.style.fontSize = '0';\n  el.style.width = '100%';\n  el.style.minHeight = height + 'px';\n  el.style.background = '#f0f0f0';\n\n  if (!el.hasAttribute('data-id')) {\n    el.setAttribute('data-id', nextId.toString());\n    nextId++;\n  }\n\n  whenVisible(el, replaceScriptWithWidget);\n}\n\nfunction lazilyReplaceAllScriptsWithWidget() {\n  let scripts = document.querySelectorAll(\"script[type='text/p5']\");\n\n  [].slice.call(scripts).forEach((el: HTMLScriptElement) => {\n    lazilyReplaceScriptWithWidget(el);\n  });\n}\n\nif (autoload) {\n  if (document.readyState === 'complete') {\n    lazilyReplaceAllScriptsWithWidget();\n  } else {\n    window.addEventListener(\n      'load',\n      lazilyReplaceAllScriptsWithWidget,\n      false\n    );\n  }\n}\n\nwindow['p5Widget'] = {\n  baseURL: myBaseURL,\n  url: myBaseURL + MY_FILENAME,\n  replaceScript: lazilyReplaceScriptWithWidget,\n  replaceAll: lazilyReplaceAllScriptsWithWidget,\n  defaults: defaults\n};\n\n\n\n// WEBPACK FOOTER //\n// ./lib/p5-widget.ts","export const P5_VERSION = '0.4.23';\nexport const PREVIEW_WIDTH = 150;\nexport const HEIGHT = 300;\nexport const MAX_RUN_TIME = 1000;\n\n\n\n// WEBPACK FOOTER //\n// ./lib/defaults.ts"],"sourceRoot":""}